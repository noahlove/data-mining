<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Principal Component Analysis | Data Mining</title>
  <meta name="description" content="Chapter 4 Principal Component Analysis | Data Mining" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Principal Component Analysis | Data Mining" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Principal Component Analysis | Data Mining" />
  
  
  

<meta name="author" content="Noah Love" />


<meta name="date" content="2021-02-19" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="a-caucus-race-and-a-long-tale.html"/>

<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Data Mining</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> A Brief Introduction</a></li>
<li class="chapter" data-level="2" data-path="the-pool-of-tears.html"><a href="the-pool-of-tears.html"><i class="fa fa-check"></i><b>2</b> The pool of tears</a></li>
<li class="chapter" data-level="3" data-path="a-caucus-race-and-a-long-tale.html"><a href="a-caucus-race-and-a-long-tale.html"><i class="fa fa-check"></i><b>3</b> A caucus-race and a long tale</a></li>
<li class="chapter" data-level="4" data-path="principal-component-analysis.html"><a href="principal-component-analysis.html"><i class="fa fa-check"></i><b>4</b> Principal Component Analysis</a>
<ul>
<li class="chapter" data-level="4.1" data-path="principal-component-analysis.html"><a href="principal-component-analysis.html#principle-component-analysis"><i class="fa fa-check"></i><b>4.1</b> Principle Component Analysis</a></li>
<li class="chapter" data-level="4.2" data-path="principal-component-analysis.html"><a href="principal-component-analysis.html#typical-machine-learning-approach"><i class="fa fa-check"></i><b>4.2</b> Typical machine learning approach</a></li>
<li class="chapter" data-level="4.3" data-path="principal-component-analysis.html"><a href="principal-component-analysis.html#what-we-would-do-in-data-mining"><i class="fa fa-check"></i><b>4.3</b> What we would do in data mining</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Mining</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="principal-component-analysis" class="section level1" number="4">
<h1><span class="header-section-number">Chapter 4</span> Principal Component Analysis</h1>
<div id="principle-component-analysis" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Principle Component Analysis</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="principal-component-analysis.html#cb1-1" aria-hidden="true" tabindex="-1"></a>hidden_p <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb1-2"><a href="principal-component-analysis.html#cb1-2" aria-hidden="true" tabindex="-1"></a>observ_p <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb1-3"><a href="principal-component-analysis.html#cb1-3" aria-hidden="true" tabindex="-1"></a>prob <span class="ot">&lt;-</span> <span class="cn">NULL</span> <span class="co"># runif(hidden_p)</span></span>
<span id="cb1-4"><a href="principal-component-analysis.html#cb1-4" aria-hidden="true" tabindex="-1"></a>h2o <span class="ot">&lt;-</span> <span class="fu">sample</span>(hidden_p,   <span class="co">#hidden to observed</span></span>
<span id="cb1-5"><a href="principal-component-analysis.html#cb1-5" aria-hidden="true" tabindex="-1"></a>              observ_p,</span>
<span id="cb1-6"><a href="principal-component-analysis.html#cb1-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">replace=</span><span class="cn">TRUE</span>,</span>
<span id="cb1-7"><a href="principal-component-analysis.html#cb1-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">prob=</span>prob)</span>
<span id="cb1-8"><a href="principal-component-analysis.html#cb1-8" aria-hidden="true" tabindex="-1"></a>h2o <span class="ot">&lt;-</span> <span class="fu">sort</span>(h2o)</span>
<span id="cb1-9"><a href="principal-component-analysis.html#cb1-9" aria-hidden="true" tabindex="-1"></a>sample_size <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb1-10"><a href="principal-component-analysis.html#cb1-10" aria-hidden="true" tabindex="-1"></a>hidden_z <span class="ot">&lt;-</span> <span class="fu">sapply</span>(</span>
<span id="cb1-11"><a href="principal-component-analysis.html#cb1-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">seq_len</span>(hidden_p),</span>
<span id="cb1-12"><a href="principal-component-analysis.html#cb1-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">function</span>(x) <span class="fu">rnorm</span>(sample_size))</span>
<span id="cb1-13"><a href="principal-component-analysis.html#cb1-13" aria-hidden="true" tabindex="-1"></a>corrs <span class="ot">&lt;-</span> <span class="fu">runif</span>(observ_p, <span class="fl">0.3</span>, <span class="fl">0.8</span>)</span>
<span id="cb1-14"><a href="principal-component-analysis.html#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="principal-component-analysis.html#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co">#create five groups of colinear stuff</span></span>
<span id="cb1-16"><a href="principal-component-analysis.html#cb1-16" aria-hidden="true" tabindex="-1"></a>observ_x <span class="ot">&lt;-</span> <span class="fu">mapply</span>(</span>
<span id="cb1-17"><a href="principal-component-analysis.html#cb1-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">function</span>(i, corr) {</span>
<span id="cb1-18"><a href="principal-component-analysis.html#cb1-18" aria-hidden="true" tabindex="-1"></a>  hidden_z[, i] <span class="sc">*</span> corr <span class="sc">+</span> <span class="fu">rnorm</span>(sample_size) <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> corr) <span class="sc">*</span><span class="dv">100</span></span>
<span id="cb1-19"><a href="principal-component-analysis.html#cb1-19" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb1-20"><a href="principal-component-analysis.html#cb1-20" aria-hidden="true" tabindex="-1"></a>  h2o, corrs)</span>
<span id="cb1-21"><a href="principal-component-analysis.html#cb1-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-22"><a href="principal-component-analysis.html#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="co">#observ_x is what you often see, but there is still hidden stuff</span></span>
<span id="cb1-23"><a href="principal-component-analysis.html#cb1-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-24"><a href="principal-component-analysis.html#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="fu">image</span>(<span class="fu">cor</span>(observ_x))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="principal-component-analysis.html#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#This looks weird to what we expect. It doesn&#39;t look like five groups</span></span>
<span id="cb2-2"><a href="principal-component-analysis.html#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co">#if we sort instead it works</span></span>
<span id="cb2-3"><a href="principal-component-analysis.html#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="principal-component-analysis.html#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="principal-component-analysis.html#cb2-5" aria-hidden="true" tabindex="-1"></a>h2o <span class="ot">&lt;-</span> <span class="fu">sample</span>(hidden_p,   <span class="co">#hidden to observed</span></span>
<span id="cb2-6"><a href="principal-component-analysis.html#cb2-6" aria-hidden="true" tabindex="-1"></a>              observ_p,</span>
<span id="cb2-7"><a href="principal-component-analysis.html#cb2-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">replace=</span><span class="cn">TRUE</span>,</span>
<span id="cb2-8"><a href="principal-component-analysis.html#cb2-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">prob=</span>prob)</span>
<span id="cb2-9"><a href="principal-component-analysis.html#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="principal-component-analysis.html#cb2-10" aria-hidden="true" tabindex="-1"></a>sample_size <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb2-11"><a href="principal-component-analysis.html#cb2-11" aria-hidden="true" tabindex="-1"></a>hidden_z <span class="ot">&lt;-</span> <span class="fu">sapply</span>(</span>
<span id="cb2-12"><a href="principal-component-analysis.html#cb2-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">seq_len</span>(hidden_p),</span>
<span id="cb2-13"><a href="principal-component-analysis.html#cb2-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">function</span>(x) <span class="fu">rnorm</span>(sample_size))</span>
<span id="cb2-14"><a href="principal-component-analysis.html#cb2-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-15"><a href="principal-component-analysis.html#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="co">#This effects how things are correlated!</span></span>
<span id="cb2-16"><a href="principal-component-analysis.html#cb2-16" aria-hidden="true" tabindex="-1"></a>corrs <span class="ot">&lt;-</span> <span class="fu">runif</span>(observ_p, <span class="fl">0.3</span>, <span class="fl">0.8</span>)</span>
<span id="cb2-17"><a href="principal-component-analysis.html#cb2-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-18"><a href="principal-component-analysis.html#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="co">#create five groups of colinear stuff</span></span>
<span id="cb2-19"><a href="principal-component-analysis.html#cb2-19" aria-hidden="true" tabindex="-1"></a>observ_x <span class="ot">&lt;-</span> <span class="fu">mapply</span>(</span>
<span id="cb2-20"><a href="principal-component-analysis.html#cb2-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">function</span>(i, corr) {</span>
<span id="cb2-21"><a href="principal-component-analysis.html#cb2-21" aria-hidden="true" tabindex="-1"></a>  hidden_z[, i] <span class="sc">*</span> corr <span class="sc">+</span> <span class="fu">rnorm</span>(sample_size) <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> corr)</span>
<span id="cb2-22"><a href="principal-component-analysis.html#cb2-22" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb2-23"><a href="principal-component-analysis.html#cb2-23" aria-hidden="true" tabindex="-1"></a>  h2o, corrs)</span>
<span id="cb2-24"><a href="principal-component-analysis.html#cb2-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-25"><a href="principal-component-analysis.html#cb2-25" aria-hidden="true" tabindex="-1"></a><span class="co">#observ_x is what you often see, but there is still hidden stuff</span></span>
<span id="cb2-26"><a href="principal-component-analysis.html#cb2-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-27"><a href="principal-component-analysis.html#cb2-27" aria-hidden="true" tabindex="-1"></a><span class="fu">image</span>(<span class="fu">cor</span>(observ_x))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-1-2.png" width="672" /></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="principal-component-analysis.html#cb3-1" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="fu">runif</span>(hidden_p, <span class="sc">-</span><span class="dv">10</span>, <span class="dv">10</span>)</span>
<span id="cb3-2"><a href="principal-component-analysis.html#cb3-2" aria-hidden="true" tabindex="-1"></a>noise <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(sample_size, <span class="at">sd=</span><span class="dv">10</span>)</span>
<span id="cb3-3"><a href="principal-component-analysis.html#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co">#hard to measure hidden forces!</span></span>
<span id="cb3-4"><a href="principal-component-analysis.html#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co">#we can only measure x, but x is only correlated to hidden stuff</span></span>
<span id="cb3-5"><a href="principal-component-analysis.html#cb3-5" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> hidden_z <span class="sc">%*%</span> beta <span class="sc">+</span> noise</span>
<span id="cb3-6"><a href="principal-component-analysis.html#cb3-6" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(y, observ_x)</span>
<span id="cb3-7"><a href="principal-component-analysis.html#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="principal-component-analysis.html#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co">#y depends on the hidden stuff not x</span></span></code></pre></div>
<p>Maybe there is a hidden gene inside of you that makes you sick. We can’t (yet) measure that hidden gene. But we can measure symptoms and things like your heart rate. This should be correlated.</p>
</div>
<div id="typical-machine-learning-approach" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Typical machine learning approach</h2>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="principal-component-analysis.html#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">#training data set, first 800 points (80 percent)</span></span>
<span id="cb4-2"><a href="principal-component-analysis.html#cb4-2" aria-hidden="true" tabindex="-1"></a>train <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">800</span></span>
<span id="cb4-3"><a href="principal-component-analysis.html#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="principal-component-analysis.html#cb4-4" aria-hidden="true" tabindex="-1"></a>ols <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> ., df, <span class="at">subset=</span>train)</span>
<span id="cb4-5"><a href="principal-component-analysis.html#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(ols<span class="sc">$</span>residual) <span class="co">#correct length</span></span></code></pre></div>
<pre><code>## [1] 800</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="principal-component-analysis.html#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">#predict on points we didn&#39;t use to train</span></span>
<span id="cb6-2"><a href="principal-component-analysis.html#cb6-2" aria-hidden="true" tabindex="-1"></a>ols_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(ols, df[<span class="sc">-</span>train,])</span>
<span id="cb6-3"><a href="principal-component-analysis.html#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="principal-component-analysis.html#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co">#error: differrence between measured values against predict. Mean of this squared MSE!</span></span>
<span id="cb6-5"><a href="principal-component-analysis.html#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>((df<span class="sc">$</span>y[<span class="sc">-</span>train] <span class="sc">-</span> ols_pred)<span class="sc">^</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 117.7051</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="principal-component-analysis.html#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">#run ols </span></span>
<span id="cb8-2"><a href="principal-component-analysis.html#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="principal-component-analysis.html#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co">#PCA TIME</span></span>
<span id="cb8-4"><a href="principal-component-analysis.html#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co">#only input X, (feature matrix) into the PCA function</span></span>
<span id="cb8-5"><a href="principal-component-analysis.html#cb8-5" aria-hidden="true" tabindex="-1"></a>pr_out <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(observ_x, <span class="at">scale=</span><span class="cn">FALSE</span>)</span>
<span id="cb8-6"><a href="principal-component-analysis.html#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="principal-component-analysis.html#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co">#scale is used because Xs might not be in the same unit, so mean = 0, sd = 1</span></span>
<span id="cb8-8"><a href="principal-component-analysis.html#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(pr_out)</span></code></pre></div>
<pre><code>## [1] &quot;prcomp&quot;</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="principal-component-analysis.html#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">#it has its own class</span></span>
<span id="cb10-2"><a href="principal-component-analysis.html#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(pr_out)</span></code></pre></div>
<pre><code>## [1] &quot;sdev&quot;     &quot;rotation&quot; &quot;center&quot;  
## [4] &quot;scale&quot;    &quot;x&quot;</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="principal-component-analysis.html#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">#squared value of sdev is eigenvalue</span></span>
<span id="cb12-2"><a href="principal-component-analysis.html#cb12-2" aria-hidden="true" tabindex="-1"></a>eigen_val <span class="ot">&lt;-</span> pr_out<span class="sc">$</span>sdev<span class="sc">^</span><span class="dv">2</span> </span>
<span id="cb12-3"><a href="principal-component-analysis.html#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="principal-component-analysis.html#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co">#cumulative sum as a fraction of total eigenvalues</span></span>
<span id="cb12-5"><a href="principal-component-analysis.html#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">cumsum</span>(eigen_val) <span class="sc">/</span> <span class="fu">sum</span>(eigen_val))</span>
<span id="cb12-6"><a href="principal-component-analysis.html#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span>.<span class="dv">9</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="principal-component-analysis.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">#here after the 5th point, the slope tapers off! This is directly related to the hidden_p value at the beginning. It should help show you how many important hidden features there are. </span></span>
<span id="cb13-2"><a href="principal-component-analysis.html#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="principal-component-analysis.html#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co">#it is the percent of variabilitiy caputured by the first k components</span></span>
<span id="cb13-4"><a href="principal-component-analysis.html#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="principal-component-analysis.html#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co">#If you don&#39;t know what to choose, 90% variability is a good point </span></span>
<span id="cb13-6"><a href="principal-component-analysis.html#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="principal-component-analysis.html#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="principal-component-analysis.html#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pr_out<span class="sc">$</span>sdev)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-3-2.png" width="672" /></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="principal-component-analysis.html#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Very similar, but not as interpretable as percent of variability. </span></span>
<span id="cb14-2"><a href="principal-component-analysis.html#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="principal-component-analysis.html#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co">#These steps is how k is chosen.</span></span>
<span id="cb14-4"><a href="principal-component-analysis.html#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="principal-component-analysis.html#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="co">#K is the dimension of W. Data came n x p. We need to shrink it to k. If you don&#39;t have</span></span>
<span id="cb14-6"><a href="principal-component-analysis.html#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="co">#a clear cut, use 90%</span></span>
<span id="cb14-7"><a href="principal-component-analysis.html#cb14-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-8"><a href="principal-component-analysis.html#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="co">#we don&#39;t want to keep all the variability because not all features provide useful</span></span>
<span id="cb14-9"><a href="principal-component-analysis.html#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="co">#information. Some of them are so colinear, they just add noise. </span></span>
<span id="cb14-10"><a href="principal-component-analysis.html#cb14-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-11"><a href="principal-component-analysis.html#cb14-11" aria-hidden="true" tabindex="-1"></a>cutoff <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb14-12"><a href="principal-component-analysis.html#cb14-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-13"><a href="principal-component-analysis.html#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="co">#now we are looking at x</span></span>
<span id="cb14-14"><a href="principal-component-analysis.html#cb14-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-15"><a href="principal-component-analysis.html#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="co">#only pull out first k columns</span></span>
<span id="cb14-16"><a href="principal-component-analysis.html#cb14-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-17"><a href="principal-component-analysis.html#cb14-17" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(pr_out<span class="sc">$</span>x)</span></code></pre></div>
<pre><code>## [1] 1000   30</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="principal-component-analysis.html#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(observ_x)</span></code></pre></div>
<pre><code>## [1] 1000   30</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="principal-component-analysis.html#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">#these will be the same, but we choose a cutoff. </span></span>
<span id="cb18-2"><a href="principal-component-analysis.html#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="principal-component-analysis.html#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="principal-component-analysis.html#cb18-4" aria-hidden="true" tabindex="-1"></a>W <span class="ot">&lt;-</span> pr_out<span class="sc">$</span>x[, <span class="dv">1</span><span class="sc">:</span>cutoff]</span>
<span id="cb18-5"><a href="principal-component-analysis.html#cb18-5" aria-hidden="true" tabindex="-1"></a>df_w <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(y, W)</span>
<span id="cb18-6"><a href="principal-component-analysis.html#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="principal-component-analysis.html#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="co">#should be like the ols from above</span></span>
<span id="cb18-8"><a href="principal-component-analysis.html#cb18-8" aria-hidden="true" tabindex="-1"></a>pca <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> ., df_w, <span class="at">subset=</span>train)</span>
<span id="cb18-9"><a href="principal-component-analysis.html#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="co">#same prediction</span></span>
<span id="cb18-10"><a href="principal-component-analysis.html#cb18-10" aria-hidden="true" tabindex="-1"></a>pca_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(pca, df_w[<span class="sc">-</span>train,])</span>
<span id="cb18-11"><a href="principal-component-analysis.html#cb18-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-12"><a href="principal-component-analysis.html#cb18-12" aria-hidden="true" tabindex="-1"></a><span class="co">#prediction error</span></span>
<span id="cb18-13"><a href="principal-component-analysis.html#cb18-13" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>((df_w<span class="sc">$</span>y[<span class="sc">-</span>train] <span class="sc">-</span> pca_pred)<span class="sc">^</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 122.8738</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="principal-component-analysis.html#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">#that was the classic view of PCA </span></span></code></pre></div>
</div>
<div id="what-we-would-do-in-data-mining" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> What we would do in data mining</h2>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="principal-component-analysis.html#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Now looking at rotation</span></span>
<span id="cb21-2"><a href="principal-component-analysis.html#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="principal-component-analysis.html#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="co">#k is which column are we going to examine</span></span>
<span id="cb21-4"><a href="principal-component-analysis.html#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="principal-component-analysis.html#cb21-5" aria-hidden="true" tabindex="-1"></a>j <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb21-6"><a href="principal-component-analysis.html#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pr_out<span class="sc">$</span>rotation[, j])</span>
<span id="cb21-7"><a href="principal-component-analysis.html#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="principal-component-analysis.html#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">which</span>(<span class="fu">abs</span>(pr_out<span class="sc">$</span>rotation[, j]) <span class="sc">&gt;</span> <span class="fl">0.2</span>)</span></code></pre></div>
<pre><code>##  [1]  1  2  4  6 13 15 17 19 26 27 28 30</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="principal-component-analysis.html#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># what is the truth we should be comparing to?</span></span>
<span id="cb24-2"><a href="principal-component-analysis.html#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="principal-component-analysis.html#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="principal-component-analysis.html#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="co">#What is rotation. Matrix (30 x 30 in this case)</span></span>
<span id="cb24-5"><a href="principal-component-analysis.html#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(pr_out<span class="sc">$</span>rotation)</span></code></pre></div>
<pre><code>## [1] 30 30</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="principal-component-analysis.html#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co">#it is actually p x p rather than p x k to give you more columns</span></span>
<span id="cb26-2"><a href="principal-component-analysis.html#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="principal-component-analysis.html#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(pr_out<span class="sc">$</span>rotation[,k])</span></code></pre></div>
<pre><code>## [1] -0.22431148 -0.21057597  0.03151215
## [4]  0.32194265 -0.01984672 -0.29001669</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="principal-component-analysis.html#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co">#kth eigenvector which correspods with the kth largest value (most significant) value</span></span>
<span id="cb28-2"><a href="principal-component-analysis.html#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="principal-component-analysis.html#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="principal-component-analysis.html#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="co">#this will always be 1. Property of rotation matrix</span></span>
<span id="cb28-5"><a href="principal-component-analysis.html#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(pr_out<span class="sc">$</span>rotation[,k]<span class="sc">^</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 1</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="a-caucus-race-and-a-long-tale.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/noahlove/data-mining/edit/master/04-pca_sim.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/noahlove/data-mining/blob/master/04-pca_sim.Rmd",
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
